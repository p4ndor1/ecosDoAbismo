<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Proibida // ECOS</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Jacquard+12&family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style.css">
    </head>
<body>
    <div class="scanlines"></div>

    <main class="main-content">
        
        <aside class="sidebar border-simple">
            <div class="ad-placeholder"><span>[ ADS ]</span></div>
            <a href="../index.html" class="btn-retro" style="width:100%; margin-bottom:20px; text-align:center;">&lt; VOLTAR AO INÍCIO</a>
            <div id="recent-posts-sidebar" style="margin: 20px 0;"></div>
            <div class="ad-placeholder skyscraper"><span>[ ADS ]</span></div>
        </aside>

        <div class="library-content-wrapper" style="width: 100%; overflow: hidden;">
            
            <header class="hub-hero" style="background-image: url('../img/biblioteca/hero-bg.png'); background-color: #111;">
                <div class="hub-overlay">
                    <h1 class="hub-title">BIBLIOTECA PROIBIDA</h1>
                    <p class="hub-desc">Conhecimento amaldiçoado em todas as suas formas. Obras que desafiam a sanidade.</p>
                </div>
            </header>

            <section style="margin: 30px; padding: 0 15px;">
                <p class="terminal-text">
                    Nossa seção de Tomos Malditos é uma curadoria de obras que desafiam a sanidade. Aqui, analisamos a ficção gótica e o horror cósmico, examinando volumes que foram banidos, perdidos ou que, segundo a lenda, induzem à loucura. Estes não são apenas livros; são portais narrativos que contêm verdades inconvenientes sobre a fragilidade da mente humana e a insignificância da civilização diante do Vazio.
                </p>
            </section>

            <section id="livros" class="carousel-section">
                <div class="carousel-header">
                    <h2 class="gothic-sub">Livros Malditos</h2>
                    <a href="livros.html" class="btn-retro is-small">VER TODOS >></a>
                </div>
                <div class="carousel-container" id="carousel-livros">
                    <p class="terminal-text">Carregando tomos...</p>
                </div>
            </section>

            <section id="filmes" class="carousel-section">
                <div class="carousel-header">
                    <h2 class="gothic-sub">Filmes de Terror</h2>
                    <a href="filmes.html" class="btn-retro is-small">VER TODOS >></a>
                </div>
                <div class="carousel-container" id="carousel-filmes">
                    <p class="terminal-text">Carregando fitas...</p>
                </div>
            </section>

            <section id="jogos" class="carousel-section">
                <div class="carousel-header">
                    <h2 class="gothic-sub">Jogos Obscuros</h2>
                    <a href="jogos.html" class="btn-retro is-small">VER TODOS >></a>
                </div>
                <div class="carousel-container" id="carousel-jogos">
                    <p class="terminal-text">Carregando cartuchos...</p>
                </div>
            </section>

        </div>
    </main>

    <footer class="main-footer border-double">
        <div class="footer-logo">ECOS_DO_ABISMO © 2025</div>
    </footer>

    <script type="module">
        import { db, collection, getDocs, query } from '../firebase-config.js';

        document.addEventListener('DOMContentLoaded', async () => {
            
            // Busca TODOS os posts do Firebase
            const q = query(collection(db, "posts"));
            const snapshot = await getDocs(q);
            const posts = [];
            snapshot.forEach(doc => posts.push({ id: doc.id, ...doc.data() }));

            // Função para desenhar o card
            const criarCard = (p) => `
                <div class="lib-card">
                    <div class="lib-img-box">
                        <img src="${p.imagem}" onerror="this.style.display='none'" alt="${p.titulo}">
                    </div>
                    <h4>${p.titulo}</h4>
                    <a href="../ver-post.html?id=${p.id}">ACESSAR</a>
                </div>
            `;

            // Preenche os carrosséis
            const preencher = (cat, idElem) => {
                const lista = posts.filter(p => p.categoria === cat);
                const container = document.getElementById(idElem);
                if(lista.length > 0) container.innerHTML = lista.map(criarCard).join('');
                else container.innerHTML = "<p class='terminal-text'>Nada encontrado.</p>";
            }

            preencher('livros', 'carousel-livros');
            preencher('filmes', 'carousel-filmes');
            preencher('jogos', 'carousel-jogos');
        });
    </script>
</body>
</html>